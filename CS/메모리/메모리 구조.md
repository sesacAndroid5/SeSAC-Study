# 메모리 구조
<img width="1822" height="1124" alt="image" src="https://github.com/user-attachments/assets/e65c3ef2-613d-4f4b-ab10-b538adf3ea2d" />

## 1. Code(Text) 영역
- 실행할 **프로그램의 코드**가 저장되는 영역.
- **컴파일 후 기계어**로 저장되어 있음.
- 프로그램 종료 시까지 메모리에 유지.
- **읽기 전용(Read-Only)** → 실행 중 수정 불가.
- **다른 프로세스에서 참조 가능**.

---

## 2. Data 영역
- **전역 변수**와 **static 변수**가 저장되는 영역.
- 프로그램 실행 시, `main()` 함수 호출 전에 데이터 영역에 할당.
- 프로그램 종료 시까지 메모리에 유지.
- **BSS 영역**과 **Data 영역**으로 나뉨:
  - **BSS (Block Started by Symbol)**  
    - 초기화되지 않은 전역/정적 변수 저장 영역  
    - `int count;` (초기화 없음)
  - **Data 영역**  
    - 초기화된 전역/정적 변수 저장 영역  
    - `int count = 10;`

---

## 3. Heap 영역
- **동적 메모리 할당**이 이루어지는 영역.
- **C/C++**: `malloc`, `free`, `new`, `delete`로 수동 관리.
- **Java/Kotlin**: 객체 생성 시 자동 저장, GC(Garbage Collector)가 관리.
- **낮은 주소 → 높은 주소** 방향으로 확장.
- **런타임 시 크기 결정**.

---

## 4. Stack 영역
- **함수 호출 시 자동으로 할당**, 함수 종료 시 자동 해제.
- 지역 변수, 매개변수, 함수 리턴 주소 등이 저장됨.
- **스레드마다 독립적으로 존재**.
- **높은 주소 → 낮은 주소** 방향으로 확장.

---

## 5. Stack vs Heap 비교

| 구분       | Stack                    | Heap                                   |
|------------|--------------------------|----------------------------------------|
| **할당 시점** | 함수 호출 시 자동 할당      | 실행 중 필요 시 동적 할당               |
| **크기**     | 작음 (MB 단위)            | 큼 (OS 제한까지)                        |
| **속도**     | 매우 빠름                 | 상대적으로 느림                         |
| **관리**     | 자동 해제                 | 수동 해제 또는 GC                       |
| **저장 대상** | 지역 변수, 매개변수, 함수 호출 정보 | 동적 생성 객체, 배열 등                  |

---

## 6. Stack과 Heap의 관계
- **Stack 영역과 Heap 영역은 같은 공간을 공유**.
- Stack이 커지면 Heap이 작아지고, Heap이 커지면 Stack이 작아짐.
- 서로의 영역을 침범하면:
  - **Stack Overflow**: Stack이 Heap 영역 침범
  - **Heap Overflow**: Heap이 Stack 영역 침범
 

## 7. Kotlin 요소 배치 
```kotlin
높은 주소 ─────────────────────────────────────────────────▶

[ Stack ]  (함수 호출 시 생성, 함수 종료 시 소멸)
  ├─ 지역 변수: val local = 10
  ├─ 함수 매개변수: fun add(a: Int, b: Int)
  ├─ 람다 참조 변수: val f = { ... }
  └─ 객체 참조(주소): val obj = MyObject

------------------------------------------
[ Heap ]   (동적 메모리, GC 관리)
  ├─ object 싱글턴 인스턴스: object Config { ... }
  ├─ companion object 인스턴스
  ├─ 람다 객체(캡처 데이터 포함)
  ├─ new로 생성된 List, String, 데이터 클래스 인스턴스
  └─ 클래스 필드 값 (초기값 있는/없는 전역 변수)

------------------------------------------
[ BSS ]    (초기값 없는 전역/정적 변수 → 0 초기화)
  └─ JVM/ART에선 실제로 Heap에 배치되지만 개념상 여기에 해당

------------------------------------------
[ Data ]   (초기값 있는 전역/정적 변수)
  └─ JVM/ART에선 Heap에 있지만, 개념상 초기값이 있는 필드

------------------------------------------
[ Text(Code) ]  (실행 코드, 상수, 리터럴)
  ├─ 확장 함수 바이트코드
  ├─ 일반 함수/메서드 바이트코드
  ├─ 람다 호출 코드
  ├─ const val 기본 타입 상수 (인라인)
  └─ String 리터럴 (String Pool → Heap에 저장, 참조는 여기서)
------------------------------------------
낮은 주소 ─────────────────────────────────────────────────▶

```


## 참고 링크
- [메모리 구조 - Velog](https://velog.io/@goserimgoserimgo/%EB%A9%94%EB%AA%A8%EB%A6%AC-%EA%B5%AC%EC%A1%B0)
